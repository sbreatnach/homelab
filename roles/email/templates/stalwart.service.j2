[Unit]
Description=Stalwart
Conflicts=postfix.service sendmail.service exim4.service
ConditionPathExists={{ email.stalwart.directory }}/etc/config.toml
After=network-online.target

[Service]
Type=simple
LimitNOFILE=65536
KillMode=process
KillSignal=SIGINT
Restart=on-failure
RestartSec=5
ExecStart={{ email.stalwart.directory }}/bin/stalwart --config={{ email.stalwart.directory }}/etc/config.toml
SyslogIdentifier=stalwart
User={{ email.stalwart.username }}
Group={{ email.stalwart.username }}
AmbientCapabilities=CAP_NET_BIND_SERVICE

[Install]
WantedBy=multi-user.target